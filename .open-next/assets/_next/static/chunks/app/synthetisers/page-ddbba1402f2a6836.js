(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[122],{2141:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let s=r(5125).A.create({baseURL:"http://localhost:4000",headers:{"Content-Type":"application/json"},withCredentials:!0}),a=["/api/auctions","/api/synthetisers","/api/users"];s.interceptors.request.use(e=>{if(!a.some(t=>{var r;return null==(r=e.url)?void 0:r.includes(t)})){let t=localStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e}),s.interceptors.response.use(e=>e,async e=>{var t;return(null==(t=e.response)?void 0:t.status)===401&&(localStorage.removeItem("token"),window.location.href="/auth/login"),Promise.reject(e)});let n=s},3307:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Q});var s=r(5155),a=r(2115),n=r(63),l=r(2663),o=r(5239);let i=e=>{let{image_url:t,title:r,onError:a,priority:n=!1}=e;return(0,s.jsx)("div",{className:"relative w-full bg-gray-50 rounded-lg overflow-hidden",style:{height:"150px",minWidth:"150px"},children:(0,s.jsx)(o.default,{src:(e=>e?e.startsWith("https")||e.startsWith("/")?e:"/".concat(e):"/images/placeholder.jpg")(t),alt:r,className:"object-cover aspect-video : ratio 16:9 rounde-lg",fill:!0,sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw",quality:90,loading:n?"eager":"lazy",onError:a})})};function c(e){let{note:t,nb_avis:r}=e;return t||r?(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[t&&(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("span",{className:"text-yellow-400 mr-1",children:"★"}),(0,s.jsx)("span",{className:"font-medium",children:t})]}),r&&(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:["(",r,")"]})]}):null}let d=e=>{let{title:t,note:r,nb_avis:a,specifications:n}=e;return(0,s.jsxs)("div",{className:"px-3 text-white",children:[(0,s.jsxs)("header",{className:"flex justify-between items-start mb-4",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-white truncate",title:t,children:t}),(0,s.jsx)(c,{note:r,nb_avis:a})]}),n&&(0,s.jsx)("p",{className:"text-gray-600 text-sm mb-4 line-clamp-3",title:n,children:n})]})};var u=r(8489),m=r(5950);let p=e=>{let{price:t=0,auctionPrices:r=[],isAuthenticated:o,isLoading:i=!1,synthId:c,onUpdateSuccess:d}=e,[p,h]=(0,a.useState)(r),[x,g]=(0,a.useState)(!1),[f,v]=(0,a.useState)(null),[b,y]=(0,a.useState)(null),j=(0,n.useRouter)(),[N,w]=(0,a.useState)(""),S=e=>{let t=Math.floor((new Date().getTime()-e.getTime())/1e3),r=Math.floor(t/60),s=Math.floor(r/60),a=Math.floor(s/24);return a>0?"il y a ".concat(a," jour").concat(a>1?"s":""):s>0?"il y a ".concat(s," heure").concat(s>1?"s":""):r>0?"il y a ".concat(r," minute").concat(r>1?"s":""):"il y a ".concat(t," seconde").concat(t>1?"s":"")},k=t?"object"==typeof t&&"value"in t?t.value:"number"==typeof t?t:0:0,A=(0,a.useCallback)(()=>p&&0!==p.length?[...p].sort((e,t)=>t.proposal_price-e.proposal_price)[0]:null,[p]),E=(0,a.useCallback)(async()=>{try{let e=await fetch("".concat(m.H,"/api/synthetisers/").concat(c,"/auctions/latest"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}}),t=await e.json();if(t){let e=new Date,r={...t,createdAt:t.createdAt||e.toISOString(),updatedAt:t.updatedAt||e.toISOString(),proposal_price:parseFloat(t.proposal_price)};h([r])}}catch(e){console.error("Erreur d\xe9taill\xe9e du fetch:",e)}finally{g(!1)}},[c]),C=async()=>{if(!o())return void j.push("/login");if(!b)return void l.oR.error("Veuillez entrer un montant");let e=A();if(b<=(e?Math.max(e.proposal_price+1,k+1):k+1))return void l.oR.error(e?"Le montant doit \xeatre sup\xe9rieur \xe0 la derni\xe8re ench\xe8re":"Le montant doit \xeatre sup\xe9rieur au prix initial");try{g(!0),v(null);let e=localStorage.getItem("token");if(!e)return void j.push("/login");let t=JSON.parse(atob(e.split(".")[1])).id,r=await u.F.post("".concat(m.H,"/api/synthetisers/").concat(c,"/auctions"),{proposal_price:Number(b),status:"active",userId:t});201===r.status&&(await E(),y(null),l.oR.success("Ench\xe8re plac\xe9e avec succ\xe8s"),d&&d())}catch(t){let e=t instanceof Error?t.message:"Erreur lors de la cr\xe9ation de l'ench\xe8re";v(e),l.oR.error(e)}finally{g(!1)}},R=A(),_=R&&!isNaN(R.proposal_price)?Math.max(R.proposal_price+1,k+1):k+1;return(0,a.useEffect)(()=>{c&&E()},[E,c]),(0,a.useEffect)(()=>{if(!R){console.log("Pas d'ench\xe8re disponible"),w("rien pour le moment");return}console.log("Donn\xe9es brutes de l'ench\xe8re:",R);let e=()=>{let e=(e=>{if(!e)return console.log("Pas d'ench\xe8re fournie \xe0 getAuctionDate"),null;if(console.log("Tentative de cr\xe9ation de date avec:",{updatedAt:e.updatedAt,typeUpdatedAt:typeof e.updatedAt,createdAt:e.createdAt,typeCreatedAt:typeof e.createdAt}),console.log("Tentative de cr\xe9ation de date avec:",{updatedAt:e.updatedAt,typeUpdatedAt:typeof e.updatedAt,createdAt:e.createdAt,typeCreatedAt:typeof e.createdAt}),e.updatedAt){let t=new Date(e.updatedAt);if(console.log("Date cr\xe9\xe9e depuis updatedAt:",t),!isNaN(t.getTime()))return t}if(e.createdAt){let t=new Date(e.createdAt);if(console.log("Date cr\xe9\xe9e depuis createdAt:",t),!isNaN(t.getTime()))return t}return console.log("Aucune date valide n'a pu \xeatre cr\xe9\xe9e"),null})(R);return R&&R.proposal_price?isNaN(R.proposal_price)?void w("0€"):e?void w(S(e)):void w(S(new Date)):void w("Pas d'ench\xe8re pour le moment")};e();let t=setInterval(e,1e3);return()=>clearInterval(t)},[R]),console.log("Prix re\xe7u:",t),console.log("Type du prix:",typeof t),console.log("Prix affich\xe9:",k),(0,s.jsxs)("div",{className:"flex flex-col space-y-4",children:[f&&(0,s.jsx)("div",{className:"text-red-500",children:f}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"text-left font-semibold",children:null===t||0===k?(0,s.jsxs)("span",{className:"text-white",children:["Fixez votre prix ! ",(0,s.jsx)("br",{})," Sur inscription"]}):"Prix initial: ".concat(k,"€")}),(0,s.jsx)("div",{children:R?(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("div",{className:"font-semibold text-white",children:["Derni\xe8re ench\xe8re:"," ",isNaN(R.proposal_price)?"0€":"".concat(R.proposal_price,"€")]}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:N||R.updatedAt?new Date(R.updatedAt).toLocaleString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):R.createdAt?new Date(R.createdAt).toLocaleString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Date non disponible"})]}):(0,s.jsx)("div",{children:"Aucune ench\xe8re - Soyez le premier \xe0 ench\xe9rir! Avec inscription"})})]}),o()&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("input",{type:"number",value:b||"",onChange:e=>y(e.target.value?Number(e.target.value):null),min:String(_),className:"w-full p-2 border rounded",placeholder:"Montant minimum: ".concat(_,"€")}),(0,s.jsx)("button",{onClick:C,disabled:i||x||!b||b<_||isNaN(b),className:"w-full py-2 px-4 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50",children:x?"Ench\xe8re en cours...":"Placer l'ench\xe8re"})]})]})};var h=r(9631),x=r(5229),g=r(4269);let f=h.bL;h.l9;let v=h.ZL,b=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(h.hJ,{ref:t,className:(0,g.cn)("fixed inset-0 z-50 bg-black/50 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...a})});b.displayName=h.hJ.displayName;let y=a.forwardRef((e,t)=>{let{className:r,children:a,...n}=e;return(0,s.jsxs)(v,{children:[(0,s.jsx)(b,{}),(0,s.jsxs)(h.UC,{ref:t,className:(0,g.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...n,children:[a,(0,s.jsxs)(h.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(x.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});y.displayName=h.UC.displayName;let j=e=>{let{className:t,...r}=e;return(0,s.jsx)("div",{className:(0,g.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...r})};j.displayName="DialogHeader";let N=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(h.hE,{ref:t,className:(0,g.cn)("text-lg font-semibold leading-none tracking-tight",r),...a})});N.displayName=h.hE.displayName;let w=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(h.VY,{ref:t,className:(0,g.cn)("text-sm text-muted-foreground",r),...a})});w.displayName=h.VY.displayName;var S=r(3101);let k=(0,S.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),A=a.forwardRef((e,t)=>{let{className:r,variant:a,children:n,...l}=e;return(0,s.jsx)("div",{ref:t,role:"alert",className:(0,g.cn)(k({variant:a}),r),...l,children:n})});A.displayName="Alert",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("h5",{ref:t,className:(0,g.cn)("mb-1 font-medium leading-none tracking-tight",r),...a})}).displayName="AlertTitle";let E=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,g.cn)("text-sm [&_p]:leading-relaxed",r),...a})});E.displayName="AlertDescription";let C=(0,S.F)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),R=a.forwardRef((e,t)=>{let{className:r,variant:a,size:n,...l}=e;return(0,s.jsx)("button",{className:(0,g.cn)(C({variant:a,size:n,className:r})),ref:t,...l})});R.displayName="Button";var _=r(919);let I=e=>{let{originalSynth:t,onSuccess:r}=e,i=(0,n.useRouter)(),[c,d]=(0,a.useState)(null),[p,h]=(0,a.useState)(!1),[x,g]=(0,a.useState)(!1),[f,v]=(0,a.useState)({marque:t.marque||"",modele:t.modele||"",specifications:t.specifications||"",image_url:t.image_url||"",price:""}),b=async e=>{e.preventDefault(),d(null),h(!0);try{if(!localStorage.getItem("token"))throw Error("Non authentifi\xe9");let e=parseFloat(f.price);if(isNaN(e)||e<=0)throw Error("Veuillez d\xe9finir un prix valide");let s=await u.F.post("".concat(m.H,"/api/synthetisers/").concat(t.id,"/duplicate"),{price:e,currency:"EUR"});201===s.status&&s.data&&(l.oR.success("Synth\xe9tiseur dupliqu\xe9 avec succ\xe8s"),r&&r(),s.data.id?i.push("/synthetisers/".concat(s.data.id)):i.push("/synthetisers"))}catch(e){if(e instanceof _.pe){var s,a,n,o;console.error("Erreur de duplication:",null==(s=e.response)?void 0:s.data);let t=(null==(n=e.response)||null==(a=n.data)?void 0:a.message)||"Erreur lors de la duplication du synth\xe9tiseur";d(t),l.oR.error(t),(null==(o=e.response)?void 0:o.status)===403&&i.push("/login")}else e instanceof Error?(console.error("Erreur:",e.message),d(e.message),l.oR.error(e.message)):(d("Une erreur inattendue est survenue"),l.oR.error("Une erreur inattendue est survenue"))}finally{h(!1)}};return(0,s.jsxs)("div",{className:"w-full max-w-4xl mx-auto p-6",children:[(0,s.jsxs)("div",{className:"mb-6",children:[f.image_url&&!x&&(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-white mb-1",children:"Illustration"}),(0,s.jsx)("div",{className:"relative w-full",children:(0,s.jsx)(o.default,{src:f.image_url,alt:"Aper\xe7u",width:200,height:200,className:"object-contain rounded",onError:()=>g(!0)})})]}),(0,s.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Synth\xe9tiseur d'origine :"}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Marque :"})," ",t.marque]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Mod\xe8le :"})," ",t.modele]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Prix de r\xe9f\xe9rence :"})," ",t.price?"".concat("object"==typeof t.price?t.price.value:t.price," EUR"):(0,s.jsx)("span",{className:"text-blue-600 italic",children:"Pas de prix de r\xe9f\xe9rence"})]})]})]}),(0,s.jsxs)("form",{onSubmit:b,className:"space-y-6",children:[c&&(0,s.jsx)(A,{variant:"destructive",children:(0,s.jsx)(E,{children:c})}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-white mb-1",children:"Prix de votre annonce (EUR)*"}),(0,s.jsx)("input",{type:"number",value:null===f.price?"":f.price,onChange:e=>{v(t=>({...t,price:e.target.value}))},required:!0,min:"0",step:"0.01",className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500",disabled:p,placeholder:"Entrez un prix"})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-4 mt-6 text-white",children:[(0,s.jsx)(R,{type:"button",variant:"outline",onClick:()=>{r&&r()},disabled:p,children:"Annuler"}),(0,s.jsx)(R,{type:"submit",disabled:p,children:p?"Duplication en cours...":"Dupliquer le synth\xe9tiseur"})]})]})]})},P=e=>{let{originalSynth:t,isOpen:r,onOpenChange:a,onSuccess:n,onClose:l}=e;return(0,s.jsx)(f,{open:r,onOpenChange:a,children:(0,s.jsxs)(y,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,s.jsx)(j,{children:(0,s.jsx)(N,{className:" text-white",children:"Dupliquer le synth\xe9tiseur"})}),(0,s.jsx)(I,{originalSynth:t,onSuccess:()=>{n&&n(),l()}})]})})},z=e=>{let{onEdit:t,onDelete:r,isAdmin:n,originalSynth:l,isLoading:o}=e,[i,c]=a.useState(!1);console.log("CardActions isAdmin:",n);let d=()=>c(!1);return n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex bg-white gap-2 justify-center items-center mt-4 p-4",children:[(0,s.jsx)("button",{onClick:t,disabled:o,className:"max-w-[200px] bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors",children:"\xc9diter"}),(0,s.jsx)("button",{onClick:r,disabled:o,className:"max-w-[200px] bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition-colors",children:"Supprimer"}),(0,s.jsx)("button",{onClick:()=>c(!0),disabled:o,className:"max-w-[200px] bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition-colors",children:"Dupliquer"})]}),(0,s.jsx)(P,{originalSynth:l,isOpen:i,onOpenChange:c,onClose:d,isAdmin:n,onSuccess:()=>{d()}})]}):null};var q=r(5654),D=r(2619),T=r.n(D);let U=(0,a.memo)(e=>{let{posts:t=[],showPosts:r,onToggle:a,synthetiserId:n,isLoading:o,error:i,onPostsUpdate:c}=e,d=t.filter(e=>Number(e.synthetiserId)===Number(n)),u=async()=>{try{let e=await fetch("".concat(m.H,"/api/posts?synthetiserId=").concat(n),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(!e.ok)throw Error("Erreur lors de la r\xe9cup\xe9ration des posts");let t=await e.json();c&&c(t)}catch(e){console.error("Erreur lors de la mise \xe0 jour des posts:",e),l.oR.error("Erreur lors de la mise \xe0 jour des posts")}};return(0,s.jsxs)("div",{className:"mt-4 space-y-4 divide-y divide-gray-200",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-100 rounded",children:[(0,s.jsxs)("span",{className:"text-gray-700 font-medium",children:["Posts (",d.length,")"]}),(0,s.jsx)("button",{onClick:a,className:"px-3 py-1 text-sm text-black hover:bg-pink-200 rounded-full transition-colors",disabled:o,children:r?"Masquer les posts ▼":"Voir les posts ▶"})]}),r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"space-y-4",children:i?(0,s.jsx)("div",{className:"p-4 bg-red-50 text-red-600 rounded-md",children:(0,s.jsx)("p",{children:i})}):o?(0,s.jsx)("div",{className:"flex justify-center items-center p-4",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-gray-200 border-t-blue-600"})}):0===d.length?(0,s.jsx)("p",{className:"p-4 text-gray-500",children:"Aucun post pour le moment"}):d.map(e=>{var t,r,a,n;return(0,s.jsxs)("div",{className:"pt-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-xs text-gray-600",children:(null==(a=e.author)||null==(r=a.username)||null==(t=r[0])?void 0:t.toUpperCase())||"U"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium text-sm text-gray-900",children:(null==(n=e.author)?void 0:n.username)||"Utilisateur inconnu"}),(0,s.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:e.createdAt?new Date(e.createdAt).toLocaleDateString():"Date inconnue"})]})]}),e.titre&&(0,s.jsx)("h3",{className:"font-semibold text-gray-900",children:e.titre}),e.commentaire&&(0,s.jsx)("p",{className:"mt-1 text-gray-600 text-sm",children:e.commentaire}),e.url_contenu&&(0,s.jsx)(T(),{href:e.url_contenu,className:"mt-2 inline-flex items-center text-sm text-blue-500 hover:text-blue-700",target:"_blank",rel:"noopener noreferrer",children:"Voir le contenu"}),(0,s.jsxs)("span",{className:"block mt-2 text-sm text-gray-500",children:["Statut: ",e.statut]})]},e.id)})}),!o&&!i&&(0,s.jsx)(q.w,{synthetiserId:n,onPostAdded:u})]})]})});U.displayName="CardPost";let F=e=>{var t,r,l,i,c,d,u,m,p,h,x,g;let{error:f,synth:v,onSubmit:b,isLoading:y,onCancel:j,onOpenChange:N,onUpdateSuccess:w,isAuthenticated:S}=e,[k,C]=(0,a.useState)(""),[R,_]=(0,a.useState)(!1),[I,P]=(0,a.useState)(!1),z=(0,n.useRouter)(),[q,D]=(0,a.useState)({marque:null!=(i=null==v?void 0:v.marque)?i:"",modele:null!=(c=null==v?void 0:v.modele)?c:"",image_url:null!=(d=null==v?void 0:v.image_url)?d:"",specifications:null!=(u=null==v?void 0:v.specifications)?u:"",price:"number"==typeof(null==v?void 0:v.price)?v.price:null!=(m=null==v||null==(t=v.price)?void 0:t.value)?m:null,proposal_price:null!=(p=null==v||null==(l=v.auctionPrices)||null==(r=l[0])?void 0:r.proposal_price)?p:null,auctionPrices:null!=(h=null==v?void 0:v.auctionPrices)?h:[],posts:null!=(x=null==v?void 0:v.posts)?x:[]}),T=(0,a.useCallback)(e=>{let{name:t,value:r}=e.target;D(e=>({...e,[t]:"price"===t||"proposal_price"===t?""===r?null:Number(r):r}))},[]),U=(0,a.useCallback)(e=>{_(!1),D(t=>({...t,image_url:e.target.value}))},[]),F=(0,a.useCallback)(()=>{_(!0)},[]),O=async e=>{if(e.preventDefault(),!S)return void z.push("/login");C(""),P(!0);try{let e=localStorage.getItem("token");if(!e)return void z.push("/login");try{let t=JSON.parse(atob(e.split(".")[1]));if(t.exp&&1e3*t.exp<Date.now()){localStorage.removeItem("token"),z.push("/login");return}let r={id:null==v?void 0:v.id,marque:q.marque,modele:q.modele,image_url:q.image_url||void 0,specifications:q.specifications||void 0,price:null!==q.price?{value:Number(q.price),currency:"EUR"}:void 0};await b(r),N(!1),w&&w()}catch(e){localStorage.removeItem("token"),z.push("/login");return}}catch(e){C(e instanceof Error?e.message:"Erreur lors de la mise \xe0 jour")}finally{P(!1)}},L=(0,a.useCallback)(()=>{q.marque||q.modele?window.confirm("Voulez-vous vraiment annuler ?")&&(j(),N(!1)):(j(),N(!1))},[q.marque,q.modele,j,N]);return(0,s.jsxs)("div",{className:"w-full space-y-4",children:[(k||f)&&(0,s.jsx)(A,{variant:"destructive",children:(0,s.jsx)(E,{children:k||f})}),(0,s.jsxs)("form",{onSubmit:O,id:"main-form",className:" flex justify-around",children:[(0,s.jsxs)("div",{className:"space-y-9",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-white",children:"Marque"}),(0,s.jsx)("input",{type:"text",name:"marque",value:q.marque,onChange:T,required:!0,className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500",disabled:y})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-white mb-1",children:"Mod\xe8le"}),(0,s.jsx)("input",{type:"text",name:"modele",value:q.modele,onChange:T,required:!0,className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500",disabled:y})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-white mb-1",children:"Sp\xe9cifications"}),(0,s.jsx)("textarea",{name:"specifications",value:q.specifications,onChange:T,className:"w-96 p-2 border rounded focus:ring-2 focus:ring-blue-500 h-48",disabled:y})]}),(0,s.jsx)("label",{className:"block text-sm font-medium text-white  mt-3",children:"URL de l'image"}),(0,s.jsx)("input",{type:"url",name:"image_url",value:q.image_url,onChange:U,className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500",disabled:y})]})]}),(0,s.jsxs)("div",{className:"space-y-10",children:[(0,s.jsx)("div",{className:"relative h-64 w-64 mx-auto",children:q.image_url&&!R?(0,s.jsx)("div",{className:"relative w-full h-full rounded-full overflow-hidden",children:(0,s.jsx)(o.default,{src:q.image_url,alt:"Aper\xe7u",fill:!0,className:"object-cover",onError:F})}):(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 rounded-full",children:(0,s.jsx)("span",{className:"text-gray-500",children:"Image non disponible"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-white mb-1",children:"Prix"}),(0,s.jsx)("input",{type:"number",name:"price",value:null!=(g=q.price)?g:"",onChange:e=>D(t=>({...t,price:""===e.target.value?null:Number(e.target.value)})),min:"0",step:"0.01",className:"p-2 border rounded focus:ring-2 focus:ring-blue-500",disabled:y})]}),(null==v?void 0:v.auctionPrices)&&v.auctionPrices.length>0&&(0,s.jsx)("div",{className:"border-t pt-4 mt-4",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-white",children:"Derni\xe8re ench\xe8re"}),(0,s.jsxs)("div",{className:"text-lg font-semibold text-red-600",children:[q.proposal_price," EUR"]})]})}),(0,s.jsxs)("div",{className:"flex justify-start space-x-2 pt-2",children:[(0,s.jsx)("button",{type:"button",onClick:L,disabled:y,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Annuler"}),(0,s.jsx)("button",{type:"submit",disabled:y||I,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors disabled:opacity-50",children:y?"Sauvegarde...":v?"Mettre \xe0 jour":"Cr\xe9er"})]})]})]})]})},O=e=>{let{isOpen:t,onOpenChange:r,synth:a,error:n,isLoading:l,onSubmit:o,onCancel:i}=e;return(0,s.jsxs)(f,{open:t,onOpenChange:r,children:[(0,s.jsx)(b,{className:"bg-black/50 backdrop-blur-sm"})," ",(0,s.jsxs)(y,{className:"max-h-[95vh] w-[200vw] max-w-5xl overflow-y-auto p-6",children:[(0,s.jsx)("div",{className:"sticky top-0 right-0 z-50 flex justify-end",children:(0,s.jsx)("button",{onClick:()=>r(!1),className:"rounded-full p-2 hover:bg-gray-100","aria-label":"Fermer"})}),(0,s.jsxs)(j,{className:"pt-4",children:[(0,s.jsx)(N,{className:"text-2xl font-bold text-white",children:a?"Modifier ".concat(a.marque," ").concat(a.modele):"Modifier le synth\xe9tiseur"}),(0,s.jsxs)(w,{className:"text-white",children:[" ",a?"Modifiez les informations de votre synth\xe9tiseur ".concat(a.marque," ").concat(a.modele):"Modifiez les informations de votre synth\xe9tiseur"]})]}),n&&(0,s.jsx)("p",{className:"text-red-500",children:n}),(0,s.jsx)(F,{synth:a,onSubmit:o,isLoading:l,onCancel:i,error:n,onOpenChange:r,isAuthenticated:!0})]})]})};var L=r(5125),M=r(7358);let H=L.A.create({baseURL:"https://api-inference.huggingface.co",headers:{Authorization:"Bearer ".concat(M.env.HUGGINGFACE_API_TOKEN),"Content-Type":"application/json"},timeout:6e4});H.interceptors.request.use(e=>(console.log("Requ\xeate sortante:",{url:e.url,method:e.method,headers:e.headers}),e));var B=r(1029).hp;let V=async e=>{try{console.log("Headers:",H.defaults.headers);let t=await H.post("/models/stabilityai/stable-diffusion-xl-base-1.0",{inputs:e,parameters:{num_inference_steps:30,guidance_scale:7.5,width:1024,height:768}});console.log("Response type:",typeof t.data),console.log("Response:",t.data);let r=B.isBuffer(t.data)?t.data.toString("base64"):B.from(t.data).toString("base64");return"data:image/jpeg;base64,".concat(r)}catch(e){return console.error("Image generation failed:",e),null}},J=e=>{let{synth:t,onUpdateSuccess:r,isAuthenticated:o}=e,[c,u]=(0,a.useState)(!1),[h,x]=(0,a.useState)(!1),[g,f]=(0,a.useState)(!1),[v,b]=(0,a.useState)(!1),[y,j]=(0,a.useState)(null),[N,w]=(0,a.useState)(t.posts||[]),[S,k]=(0,a.useState)(!1),A=(0,n.useRouter)(),[E,C]=(0,a.useState)(null),{hasPermission:R}=(()=>{let[e,t]=(0,a.useState)([]),[r,s]=(0,a.useState)(!0),[n,l]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{try{let e=localStorage.getItem("token");if(!e){console.log("\uD83D\uDEAB Aucun token trouv\xe9"),t([]),s(!1);return}console.log("✅ Token trouv\xe9:",e.substring(0,20)+"..."),console.log("\uD83D\uDD04 Tentative de requ\xeate vers:","".concat(m.H,"/api/users/permissions"));let r=await L.A.get("".concat(m.H,"/api/users/permissions"),{headers:{Authorization:"Bearer ".concat(e),Accept:"application/json","Content-Type":"application/json"},withCredentials:!0});if(console.log("\uD83D\uDCE5 R\xe9ponse brute:",r.data),r.data&&r.data.permissions){let e=r.data.permissions.map(e=>e.name);console.log("✨ Permissions pars\xe9es:",e),t(e)}else console.warn("⚠️ Format de r\xe9ponse inattendu:",r.data),t([])}catch(s){if(L.A.isAxiosError(s)){var e,r,a,n;console.error("❌ Erreur Axios:",{message:s.message,response:null==(e=s.response)?void 0:e.data,status:null==(r=s.response)?void 0:r.status}),l("Erreur: ".concat((null==(n=s.response)||null==(a=n.data)?void 0:a.message)||s.message))}else console.error("❌ Erreur non-Axios:",s),l("Erreur inattendue lors de la r\xe9cup\xe9ration des permissions");t([])}finally{s(!1)}})()},[]);let o=t=>!r&&e.includes(t);return{permissions:e,hasPermission:o,hasAnyPermission:t=>(console.log("Current user permissions:",e),console.log("Checking for permissions:",t),!r&&t.some(e=>o(e))),hasAllPermissions:e=>!r&&e.every(e=>o(e)),loading:r,error:n}})(),{id:_,image_url:I,marque:q,modele:D,note:T,nb_avis:F,specifications:M,price:H,auctionPrices:B=[]}=t,J="".concat(q," ").concat(D);console.log("SynthetiserCard Rendering:",{token:localStorage.getItem("token"),hasPermission:R("synths:read"),isAuthenticated:o()}),(0,a.useEffect)(()=>{let e=async()=>{if(_){b(!0),j(null);try{let e=localStorage.getItem("token");if(!e)throw Error("No authentication token found");let t=await fetch("".concat(m.H,"/api/posts?synthetiserId=").concat(_),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!t.ok)throw Error("Failed to fetch posts: ".concat(t.status," ").concat(t.statusText));let r=await t.json();w(r)}catch(e){console.error("Error fetching posts:",e),j(e instanceof Error?e.message:"Failed to load posts"),l.oR.error("Failed to load posts")}finally{b(!1)}}};c&&e()},[_,c]);let G=(0,a.useCallback)(()=>u(e=>!e),[]),K=(0,a.useCallback)(()=>console.error("Erreur de chargement d'image"),[]),W=(0,a.useCallback)(()=>x(!0),[]),Y=(0,a.useCallback)(()=>x(!1),[]),Q=(0,a.useCallback)(async()=>{if(window.confirm("Voulez-vous vraiment supprimer ".concat(J," ?"))){f(!0);try{let e=localStorage.getItem("token");if(!e)return void A.push("/login");let t=await fetch("".concat(m.H,"/api/synthetisers/").concat(_),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}),s=await t.json();if(!t.ok){if(console.error("Erreur d\xe9taill\xe9e:",s),401===t.status){localStorage.removeItem("token"),A.push("/login");return}throw Error("Erreur ".concat(t.status,": ").concat(s.error||s.message))}if(!t.ok){if(401===t.status){localStorage.removeItem("token"),A.push("/login");return}throw Error("Erreur ".concat(t.status))}l.oR.success("".concat(J," supprim\xe9 avec succ\xe8s")),r&&await r(),A.refresh(),A.replace("/synthetisers")}catch(e){console.error("Erreur lors de la suppression:",e),l.oR.error("Erreur lors de la suppression de ".concat(J))}finally{f(!1)}}},[_,J,A,r]),Z=(0,a.useCallback)(async()=>{try{let e=localStorage.getItem("token");if(!e){l.oR.error("Session expir\xe9e"),A.push("/login");return}let t=JSON.parse(atob(e.split(".")[1]));if(2!==t.roleId)return void l.oR.error("Acc\xe8s non autoris\xe9 - Action r\xe9serv\xe9e aux administrateurs");k(!0)}catch(e){console.error("Erreur:",e),l.oR.error("Erreur lors de la duplication")}},[A]),$=(0,a.useCallback)(async e=>{try{if(!(await fetch("".concat(m.H,"/api/synthetisers/").concat(_),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(e)})).ok)throw Error();l.oR.success("Synth\xe9tiseur mis \xe0 jour"),r&&r(),x(!1)}catch(e){l.oR.error("Erreur lors de la mise \xe0 jour")}},[_,r]);return(0,a.useEffect)(()=>{(async()=>{let e=await V("synthesizer ".concat(q," ").concat(D));e&&C(e)})()},[q,D]),(0,a.useEffect)(()=>{var e;let t=localStorage.getItem("token");console.log("SynthetiserCard rendered:",{hasPermission:R("synths:read"),token:!!t,permissions:t&&(null==(e=JSON.parse(atob(t.split(".")[1])))?void 0:e.permissions)||[]})},[R]),(0,s.jsxs)(s.Fragment,{children:[console.log("Inside PermissionGuard"),!1,(0,s.jsx)("article",{className:"bg-orange-600/60 rounded-lg shadow-lg h-full w-full backdrop-blur-2xl border-2 border-blue-800",style:{backgroundImage:E?"url(".concat(E,")"):void 0},children:(0,s.jsxs)("div",{className:"flex flex-col h-full space-y-4 p-4",children:[(0,s.jsx)("div",{className:"relative h-48 w-full",children:(0,s.jsx)(i,{image_url:I,title:J,onError:K})}),(0,s.jsx)(d,{title:J,note:T,nb_avis:F,specifications:M}),(0,s.jsx)(p,{price:H,auctionPrices:B,isAuthenticated:o,isLoading:g,synthId:_.toString(),onUpdateSuccess:r,isAdmin:R("synths:update")}),(0,s.jsx)(U,{posts:N,showPosts:c,onToggle:G,synthetiserId:t.id,isLoading:v,error:y,onPostsUpdate:w}),(0,s.jsx)("div",{className:"mt-4",children:(R("synths:delete")||R("synths:update"))&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(z,{onEdit:W,onDelete:Q,onDuplicate:Z,isLoading:g,isAdmin:!0,originalSynth:t}),h&&(0,s.jsx)(O,{isOpen:h,onOpenChange:x,synth:t,onSubmit:$,onCancel:Y,onClose:Y,error:null,isLoading:g,isAuthenticated:o,isAdmin:!0}),S&&(0,s.jsx)(P,{isOpen:S,onOpenChange:k,onClose:()=>k(!1),onSuccess:r,originalSynth:t,isAdmin:!0})]})})]})})]})};var G=r(7088),K=r(2141);let W=e=>{let{isAuthenticated:t}=e,[r,n]=(0,a.useState)([]),[l,o]=(0,a.useState)(1),[i,c]=(0,a.useState)(1),[d,u]=(0,a.useState)(!1),p=(0,a.useCallback)(async e=>{console.log("Fetching synths for page:",e),u(!0);try{let t=await K.A.get("".concat(m.H,"/api/synthetisers"),{params:{page:e,limit:12}});console.log("API Response:",t.data),t.data&&t.data.synths&&(n(t.data.synths),t.data.pagination&&(c(t.data.pagination.totalPages),o(t.data.pagination.currentPage)))}catch(e){console.error("Error fetching synths:",e)}finally{u(!1)}},[12]);(0,a.useEffect)(()=>{t()&&p(1)},[p,t]);let h=()=>{p(l)};return(0,s.jsx)(G.A,{children:(0,s.jsxs)("div",{className:"flex flex-col space-y-8 relative z-10",children:[(0,s.jsx)("div",{className:"text-white text-bold col-span-8 mx-auto bg-slate-400 p-10 opacity-90 rounded-lg",children:(0,s.jsxs)("span",{children:["Liste de synthetiseurs Kawai - Korg - Roland",(0,s.jsx)("br",{}),"Donn\xe9es issues d'un scraping \xe9thique en Python du site",(0,s.jsx)("a",{href:"https://synthetiseur.net",children:" synthetiseur.net"}),(0,s.jsx)("br",{}),"Les prix indiqu\xe9s sont totalement fictifs"]})}),t()?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 p-4",children:d?(0,s.jsx)("div",{className:"col-span-full text-center text-white",children:"Chargement..."}):r&&r.length>0?r.map(e=>(0,s.jsx)(J,{synth:e,onUpdateSuccess:h,isAuthenticated:t},e.id)):(0,s.jsx)("div",{className:"col-span-full text-center text-white",children:"Aucun synth\xe9tiseur disponible"})}),r.length>0&&(0,s.jsxs)("div",{className:"flex justify-center items-center gap-4 p-4",children:[(0,s.jsx)("button",{onClick:()=>{l>1&&p(l-1)},disabled:1===l,className:"px-4 py-2 bg-pink-600 text-white rounded-lg disabled:opacity-50",children:"Pr\xe9c\xe9dent"}),(0,s.jsxs)("span",{className:"text-white",children:["Page ",l," sur ",i]}),(0,s.jsx)("button",{onClick:()=>{l<i&&p(l+1)},disabled:l===i,className:"px-4 py-2 bg-pink-600 text-white rounded-lg disabled:opacity-50",children:"Suivant"})]})]}):(0,s.jsx)("div",{className:"col-span-8 mx-auto bg-gray-600/60 p-4",children:(0,s.jsx)("h3",{className:"text-center text-xl font-bold text-white",children:"Pour d\xe9couvrir les synth\xe9tiseurs et les fonctionnalit\xe9s, connectez-vous : demo@demo.fr 012345678"})})]})})};function Y(e){let{children:t}=e,[r,n]=(0,a.useState)(""),[l,o]=(0,a.useState)(!1),[i,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(!0),[m,p]=(0,a.useState)("abstract digital art background, colorful, vibrant"),[h,g]=(0,a.useState)(0),f=async()=>{o(!0),c(null);try{let t=await fetch("/api/background",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:m})});if(!t.ok){let e=await t.json();if(503===t.status&&h<3){g(e=>e+1),setTimeout(()=>f(),2e3*(h+1)),c("Service temporairement indisponible, nouvelle tentative en cours...");return}throw Error(e.error||"Erreur lors de la g\xe9n\xe9ration")}let r=await t.json();if(r.imageUrl){n(r.imageUrl);var e=r.imageUrl;try{let t={value:e,timestamp:Date.now()};localStorage.setItem("background_image",JSON.stringify(t))}catch(e){console.error("Erreur lors de l'\xe9criture dans le cache:",e)}g(0)}}catch(e){c(e instanceof Error?e.message:"Erreur inconnue")}finally{o(!1)}};return d?(0,s.jsxs)("div",{className:"min-h-screen w-full relative",children:[(0,s.jsx)("div",{className:"\n          absolute inset-0 bg-cover bg-center transition-opacity duration-1000\n          ".concat(l?"opacity-50":"opacity-100","\n        "),style:{backgroundImage:r?"url(".concat(r,")"):void 0}}),(0,s.jsxs)("div",{className:"fixed top-20 right-4 z-50 bg-white/90 p-4 rounded-lg shadow-lg",children:[(0,s.jsx)("button",{onClick:()=>u(!1),className:"absolute top-2 right-2 text-gray-500 hover:text-gray-700",children:(0,s.jsx)(x.A,{size:20})}),(0,s.jsx)("input",{type:"text",value:m,onChange:e=>p(e.target.value),className:"w-64 px-3 py-4 border rounded-lg mb-2 text-black",placeholder:"D\xe9crivez le fond souhait\xe9..."}),(0,s.jsx)("button",{onClick:()=>f(),disabled:l,className:"\n            w-full px-4 py-2 bg-blue-900/50 text-white rounded-lg\n            ".concat(l?"opacity-50":"hover:bg-blue-600","\n          "),children:l?"G\xe9n\xe9ration...":"G\xe9n\xe9rer le fond"}),i&&(0,s.jsxs)("div",{className:"fixed bottom-4 right-4 bg-red-500/90 text-white p-4 rounded-lg shadow-lg",children:[i,h>0&&(0,s.jsxs)("div",{className:"text-sm mt-1",children:["Tentative ",h,"/3"]}),(0,s.jsx)("button",{onClick:()=>c(null),className:"absolute top-2 right-2 text-white hover:text-gray-200",children:(0,s.jsx)(x.A,{size:16})})]})]}),(0,s.jsx)("div",{className:"relative z-10",children:t})]}):(0,s.jsxs)("div",{className:"min-h-screen w-full relative",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:r?"url(".concat(r,")"):void 0}}),(0,s.jsx)("button",{onClick:()=>u(!0),className:"fixed top-20 right-4 z-50 bg-blue-900/50 text-white px-4 py-2 rounded-lg hover:bg-blue-600",children:"G\xe9n\xe9rateur de fond"}),(0,s.jsx)("div",{className:"relative z-10",children:t})]})}function Q(){let[e]=(0,a.useState)([]),[t,r]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{r(!!localStorage.getItem("token"))},[]),(0,s.jsx)(Y,{children:(0,s.jsx)("main",{className:"min-h-screen relative",children:(0,s.jsxs)("div",{className:"w-full px-4 py-6 relative z-10",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-8 text-center text-white",children:"Synth\xe9tiseurs"}),(0,s.jsx)(W,{synths:e,isAuthenticated:()=>t})]})})})}},4269:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n});var s=r(2821),a=r(5889);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}},5654:(e,t,r)=>{"use strict";r.d(t,{w:()=>c});var s=r(5155),a=r(2115),n=r(8489),l=r(5950),o=r(2663),i=r(63);function c(e){let{synthetiserId:t,onPostAdded:r}=e,[c,d]=(0,a.useState)(""),[u,m]=(0,a.useState)(""),[p,h]=(0,a.useState)(!1),[x,g]=(0,a.useState)(null),f=(0,i.useRouter)(),v=async e=>{if(e.preventDefault(),!c.trim()||!u.trim())return void g("Le titre et le commentaire sont requis");h(!0),g(null);try{let e=localStorage.getItem("token");if(!e){g("Vous devez \xeatre connect\xe9 pour ajouter un commentaire"),o.oR.error("Veuillez vous connecter");return}n.F.defaults.headers.common.Authorization="Bearer ".concat(e);let s=JSON.parse(atob(e.split(".")[1])).id,a=await n.F.post("".concat(l.H,"/api/posts"),{titre:c.trim(),commentaire:u.trim(),synthetiserId:t,userId:s,type_contenu:"texte",statut:"publi\xe9"});if(201===a.status){o.oR.success("Commentaire ajout\xe9 avec succ\xe8s"),d(""),m("");let e=await n.F.get("".concat(l.H,"/api/posts/").concat(a.data.id),{params:{include:["author"]}});200===e.status&&(r(),f.refresh())}}catch(t){var s,a;let e=(null==(a=t.response)||null==(s=a.data)?void 0:s.message)||"Erreur lors de l'ajout du commentaire";g(e),o.oR.error(e)}finally{h(!1)}};return(0,s.jsxs)("form",{onSubmit:v,className:"mt-4 space-y-4",children:[x&&(0,s.jsx)("div",{className:"text-red-500 text-sm",children:x}),(0,s.jsx)("div",{children:(0,s.jsx)("input",{type:"text",value:c,onChange:e=>d(e.target.value),placeholder:"Titre du commentaire",className:"w-full p-2 border rounded",required:!0,minLength:3})}),(0,s.jsx)("div",{children:(0,s.jsx)("textarea",{value:u,onChange:e=>m(e.target.value),placeholder:"Votre commentaire",className:"w-full p-2 border rounded",rows:3,required:!0,minLength:10})}),(0,s.jsx)("button",{type:"submit",disabled:p||!c.trim()||!u.trim(),className:"w-full py-2 px-4 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50",children:p?"Envoi en cours...":"Ajouter un commentaire"})]})}},5950:(e,t,r)=>{"use strict";r.d(t,{H:()=>s});let s="http://localhost:4000"},7088:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var s=r(5155),a=r(2115);class n extends a.Component{static getDerivedStateFromError(e){return console.error("Error caught:",e),{hasError:!0}}componentDidCatch(e,t){console.error("Erreur captur\xe9e par ErrorBoundary:",e,t)}render(){return this.state.hasError?(0,s.jsxs)("div",{className:"text-center p-4",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Une erreur est survenue"}),(0,s.jsx)("button",{onClick:()=>this.setState({hasError:!1}),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"R\xe9essayer"})]}):this.props.children}constructor(e){super(e),this.state={hasError:!1}}}let l=n},7624:(e,t,r)=>{Promise.resolve().then(r.bind(r,3307))},8489:(e,t,r)=>{"use strict";r.d(t,{F:()=>n});var s=r(5125),a=r(2378);s.A.defaults.withCredentials=!0;let n=s.A.create({baseURL:"http://localhost:4000"});n.interceptors.request.use(e=>{let t=a.A.get("token")||localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,e=>{var t;return["/api/synthetisers"].includes(e.config.url)||null==(t=e.response)||t.status,Promise.reject(e)}),n.interceptors.response.use(e=>e,e=>(e.response?(console.error("Erreur de r\xe9ponse:",{status:e.response.status,data:e.response.data}),401===e.response.status&&localStorage.removeItem("token")):e.request?console.error("Erreur de requ\xeate:",e.request):console.error("Erreur:",e.message),Promise.reject(e)))}},e=>{e.O(0,[239,125,619,80,771,675,441,255,358],()=>e(e.s=7624)),_N_E=e.O()}]);