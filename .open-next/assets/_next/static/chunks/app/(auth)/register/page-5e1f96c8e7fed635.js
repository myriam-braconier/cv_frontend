(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[678],{63:(e,s,a)=>{"use strict";var r=a(7260);a.o(r,"useParams")&&a.d(s,{useParams:function(){return r.useParams}}),a.o(r,"usePathname")&&a.d(s,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(s,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(s,{useSearchParams:function(){return r.useSearchParams}})},3526:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>c});var r=a(5155),t=a(2115),l=a(63),n=a(5125),i=a(5950);function o(){var e;let[s,a]=(0,t.useState)({username:"",email:"",password:"",confirmPassword:"",hasInstrument:!1,roleId:1}),[o,d]=(0,t.useState)([]),[c,u]=(0,t.useState)(""),[m,h]=(0,t.useState)(!1),p=(0,l.useRouter)();(0,t.useEffect)(()=>{(async()=>{try{let e=await n.A.get("".concat(i.H,"/api/roles"));d(e.data)}catch(e){console.error("Erreur lors du chargement des r\xf4les:",e),u("Impossible de charger les r\xf4les disponibles")}})()},[]);let x=e=>{let{name:s,value:r,type:t}=e.target;console.log("Change event:",{name:s,value:r,type:t}),"radio"===t&&"hasInstrument"===s?a(e=>({...e,hasInstrument:"true"===r,roleId:"true"===r?5:e.roleId})):a(e=>({...e,[s]:"roleId"===s?parseInt(r):r}))},b=async e=>{e.preventDefault(),u(""),h(!0);let{username:a,email:r,password:t,confirmPassword:l,hasInstrument:o,roleId:d}=s;if(t!==l){u("Les mots de passe ne correspondent pas"),h(!1);return}try{let e={username:a,email:r,password:t,has_instrument:o,roleId:d};console.log("Donn\xe9es envoy\xe9es \xe0 l'API:",e);let s=await n.A.post("".concat(i.H,"/auth/register"),e);if(201===s.status){let{token:e}=s.data;localStorage.setItem("token",e),p.push("/login")}console.log("R\xe9ponse du serveur:",s.data),201===s.status&&p.push("/login")}catch(e){if(n.A.isAxiosError(e)){var c,m,x,b;console.error("Erreur d\xe9taill\xe9e:",{status:null==(c=e.response)?void 0:c.status,data:null==(m=e.response)?void 0:m.data}),u((null==(b=e.response)||null==(x=b.data)?void 0:x.message)||"Erreur lors de l'inscription")}else console.error("Erreur non-Axios:",e),u("Une erreur inattendue est survenue")}finally{h(!1)}};return(0,r.jsxs)("form",{onSubmit:b,className:"mt-8 space-y-6",children:[(0,r.jsxs)("div",{className:"rounded-md -space-y-px",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"username",className:"block mb-2 text-orange-600",children:"Nom d'utilisateur"}),(0,r.jsx)("input",{type:"text",id:"username",name:"username",value:s.username,onChange:x,required:!0,className:"w-full px-3 py-2 border rounded text-black"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"email",className:"block mb-2 text-orange-600",children:"Email"}),(0,r.jsx)("input",{type:"email",id:"email",name:"email",value:s.email,onChange:x,required:!0,className:"w-full px-3 py-2 border rounded text-black"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"password",className:"block mb-2 text-red-600",children:"Mot de passe"}),(0,r.jsx)("input",{type:"password",id:"password",name:"password",value:s.password,onChange:x,required:!0,minLength:8,className:"w-full px-3 py-2 border rounded"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"confirmPassword",className:"block mb-2 text-red-600",children:"Confirmer le mot de passe"}),(0,r.jsx)("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:s.confirmPassword,onChange:x,required:!0,minLength:8,className:"w-full px-3 py-2 border rounded"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block mb-2 text-red-600",children:"\xcates-vous propri\xe9taire d'un instrument ?"}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)("label",{className:"inline-flex items-center",children:[(0,r.jsx)("input",{type:"radio",name:"hasInstrument",value:"true",checked:!0===s.hasInstrument,onChange:x,className:"form-radio h-4 w-4 text-blue-600"}),(0,r.jsx)("span",{className:"ml-2",children:"Oui"})]}),(0,r.jsxs)("label",{className:"inline-flex items-center",children:[(0,r.jsx)("input",{type:"radio",name:"hasInstrument",value:"false",checked:!1===s.hasInstrument,onChange:x,className:"form-radio h-4 w-4 text-blue-600"}),(0,r.jsx)("span",{className:"ml-2",children:"Non"})]})]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"roleId",className:"block mb-2 text-orange-600",children:"Type de compte"}),(0,r.jsx)("select",{id:"roleId",name:"roleId",value:s.roleId,onChange:x,disabled:s.hasInstrument,className:"w-full px-3 py-2 border rounded text-black ".concat(s.hasInstrument?"bg-gray-100":""),children:o.map(e=>(0,r.jsx)("option",{value:e.id,children:e.description||e.name},e.id))}),s.hasInstrument&&(0,r.jsx)("p",{className:"mt-1 text-sm text-blue-600",children:'En tant que propri\xe9taire, votre r\xf4le est automatiquement d\xe9fini comme "Propri\xe9taire"'})]}),(0,r.jsxs)("div",{className:"mt-2 p-2 bg-blue-50 rounded text-sm",children:[(0,r.jsx)("p",{className:"font-semibold",children:"R\xf4le s\xe9lectionn\xe9 :"}),(0,r.jsx)("p",{children:s.hasInstrument?"Propri\xe9taire (R\xf4le 5)":"".concat((null==(e=o.find(e=>e.id===s.roleId))?void 0:e.description)||"Utilisateur")})]})]}),c&&(0,r.jsx)("div",{className:"text-red-500 text-center",children:c}),(0,r.jsx)("button",{type:"submit",disabled:m,className:"w-full ".concat(m?"bg-gray-400":"bg-blue-500 hover:bg-blue-600"," text-white py-2 rounded"),children:m?"Inscription en cours...":"S'inscrire"})]})}var d=a(3863);function c(){return(0,r.jsxs)("main",{className:"min-h-screen relative",children:[(0,r.jsx)("div",{className:"fixed inset-0 -z-10",children:(0,r.jsx)(d.default,{images:["/images/login2.webp","/images/login.webp"]})}),(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,r.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-white bg-black/50 p-4 rounded-lg backdrop-blur-sm",children:"Inscription"}),(0,r.jsx)(o,{})]})})]})}},3723:(e,s,a)=>{Promise.resolve().then(a.bind(a,3526))},3863:(e,s,a)=>{"use strict";a.d(s,{default:()=>n});var r=a(5155),t=a(5239),l=a(2115);let n=e=>{let{images:s}=e,a=(e=>{let[s,a]=(0,l.useState)(0),r=(0,l.useCallback)(()=>{let a=Math.floor(Math.random()*e.length);return a===s?(a+1)%e.length:a},[e.length,s]);return(0,l.useEffect)(()=>{0===s&&a(r())},[r,s]),s})(s);return(0,r.jsx)("div",{className:"relative inset-0 w-full h-full",children:(0,r.jsx)("div",{className:"absolute inset-0 w-full h-full",children:(0,r.jsx)(t.default,{src:s[a],alt:"Background",fill:!0,sizes:"(max-width: 414px) 414px, (max-width: 768px) 100vw, (max-width: 1200px) 100vw, 100vw",className:"object-cover opacity-50 transition-opacity duration-500",priority:!0,quality:75})})})}},5950:(e,s,a)=>{"use strict";a.d(s,{H:()=>r});let r="http://localhost:4000"}},e=>{e.O(0,[239,125,441,255,358],()=>e(e.s=3723)),_N_E=e.O()}]);